import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as n}from"./index.C1SLTdIO.js";import{I,S as M}from"./index.loRFk-AH.js";import{a as C}from"./app-config.zEQo3iYE.js";import{l as o}from"./locale_text_site.BvdD-9Qv.js";import{Y as _}from"./index.CqrHhE94.js";import{s as E}from"./seo-data-site.CLNeXSAF.js";import{t as g}from"./contact-us.D-J7bnCy.js";import{R as $}from"./index.n-Ca5uiV.js";const P=async l=>{const{name:c,phone:t,email:h,message:a}=l,m=`
    Новый запрос на связь:
    Имя: ${c}
    Телефон: ${t}
    Email: ${h}
    Сообщение: ${a}
  `,i=`https://api.telegram.org/bot${C.TOKEN_TELEGRAM}/sendMessage`;try{if(!(await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:C.CHAT_ID_TELEGRAM,text:m,parse_mode:"HTML"})})).ok)throw new Error("Ошибка при отправке данных в Telegram");return{success:!0,message:"Сообщение успешно отправлено в Telegram."}}catch(d){return console.error("Ошибка при отправке данных в Telegram:",d),{success:!1,message:"Ошибка при отправке данных в Telegram."}}},D=({open:l,onClose:c,message:t})=>l?e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-11/12 max-w-lg",children:[e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-lg font-medium text-gray-900",children:t})}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("button",{onClick:c,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",children:o.components.reactComponents.callToActionIconReact.modalCallToAction.btnClose})})]})}):null,Y=({externalData:l,onClose:c})=>{const[t,h]=n.useState({name:g.data.is_fio_form?"":"NotName",phone:"",email:"",message:g.data.is_message_active?"":"Интересует оформление заказа / подробности (форма связаться)",externalData:l}),[a,m]=n.useState("phone"),[i,d]=n.useState(!1),[y,x]=n.useState(!1),[j,T]=n.useState(""),[A,p]=n.useState(!1),[N,w]=n.useState({phone:!1,terms:!1,contact:!1}),u=s=>{const{name:r,value:f}=s.target;h(R=>({...R,[r]:f}))},v=s=>s.replace(/\D/g,"").length===11,S=s=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s),b=t.name.trim()!==""&&t.message.trim()!==""&&i&&(a==="phone"&&v(t.phone)||a==="email"&&S(t.email)),k=async s=>{if(s.preventDefault(),!!b){p(!0),w({phone:!1,terms:!1,contact:!1});try{const r=await P(t);if(r.success){const f=new URLSearchParams({name:t.name,phone:t.phone,email:t.email,message:t.message}).toString();p(!1),window.location.href=`/thank-you?${f}`}else T(r.message||o.components.reactComponents.callToActionIconReact.formCallToAction.errorMessageDefault),p(!1),x(!0)}catch{T(o.components.reactComponents.callToActionIconReact.formCallToAction.errorMessage),p(!1),x(!0)}}};return e.jsx("div",{className:"fixed text-gray-900 inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md w-80 relative",children:[e.jsx("button",{onClick:()=>c(t),className:"absolute top-2 right-2 text-gray-500 hover:text-gray-700",children:e.jsx(I,{size:24})}),e.jsx("h2",{className:"text-lg font-bold mb-4 text-center",children:o.components.reactComponents.callToActionIconReact.formCallToAction.title}),e.jsxs("form",{onSubmit:k,children:[e.jsx("input",{type:"text",name:"name",value:t.name,placeholder:o.components.reactComponents.callToActionIconReact.formCallToAction.namePlaceholder,onChange:u,className:`${g.data.is_fio_form?"":"hidden"} block w-full p-2 mb-2 border rounded`,required:!0}),e.jsxs("div",{className:"flex space-x-2 mb-2",children:[e.jsx("button",{type:"button",onClick:()=>m("phone"),className:`px-2 py-1 rounded border ${a==="phone"?"bg-blue-500 text-white":"bg-gray-200"}`,children:"Телефон"}),e.jsx("button",{type:"button",onClick:()=>m("email"),className:`px-2 py-1 rounded border ${a==="email"?"bg-blue-500 text-white":"bg-gray-200"}`,children:"Email"})]}),a==="phone"&&e.jsx($,{mask:o.components.reactComponents.callToActionIconReact.formCallToAction.maskPlaceholder,name:"phone",value:t.phone,placeholder:o.components.reactComponents.callToActionIconReact.formCallToAction.phonePlaceholder,onChange:u,className:`block w-full p-2 mb-2 border rounded ${N.phone?"border-red-400 ring-red-100":"border-gray-300 focus:border-gray-600 ring-gray-100"}`,required:!0}),a==="email"&&e.jsx("input",{type:"email",name:"email",value:t.email,placeholder:o.components.reactComponents.callToActionIconReact.formCallToAction.emailPlaceholder,onChange:u,className:"block w-full p-2 mb-2 border rounded",required:!0}),e.jsx("textarea",{name:"message",value:t.message,placeholder:o.components.reactComponents.callToActionIconReact.formCallToAction.messagePlaceholder,onChange:u,className:`${g.data.is_message_active?"":"hidden"} block text-gray-900 w-full p-2 mb-2 border rounded`,required:!0,rows:4}),e.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[e.jsx("input",{type:"checkbox",id:"agreeToTerms",checked:i,onChange:()=>d(!i),className:"mt-1"}),e.jsxs("label",{htmlFor:"agreeToTerms",className:"text-sm",children:["Я соглашаюсь с"," ",e.jsx("a",{href:"/privacy-policy",target:"_blank",className:"text-blue-600 underline",children:"политикой конфиденциальности"})," ","и"," ",e.jsx("a",{href:"/user-agreement",target:"_blank",className:"text-blue-600 underline",children:"пользовательским соглашением"}),"."]})]}),e.jsx(_,{yaGoalTitle:E.yaGoalTitleCallToAction,children:e.jsx("button",{type:"submit",disabled:!b,className:`mt-2 w-full px-4 py-2 rounded-md ${b?"bg-blue-500 text-white hover:bg-blue-600":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:e.jsx(M,{loading:A,spinTitleText:o.components.reactComponents.callToActionIconReact.formCallToAction.btnSpinnerLoader,titleText:o.components.reactComponents.callToActionIconReact.formCallToAction.btnSend})})})]}),e.jsx(D,{open:y,onClose:()=>x(!1),message:j})]})})};export{Y as C};
